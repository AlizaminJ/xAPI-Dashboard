<!DOCTYPE html>
<html>
	<head>
		<title>WebWorker test</title>
		<script src='src/collection.js'></script>
		<script src='extra/gen-lrs-data.js'></script>
		<script>
			function ready(){
				var handle = setInterval(function(){document.body.innerHTML += '.';}, 20);
				var c = new ADL.CollectionAsync(window.statements, 'src/collection-worker.js');
				//c.where('verb.id = "http://adlnet.gov/expapi/verbs/passed" and object.id="http://myschool.edu/xapi_vocab/test1" and result.score.raw >= 91' ).exec(function(msg){
				//c.select('result.score.raw as score, verb.id').exec(function(msg){
				//c.orderBy('result.score.raw').slice(-10).exec(function(msg){
				c.where('result.score.raw != null').groupBy('actor.name',['a','z',5]).max('result.score.raw').exec(function(msg){
					clearInterval(handle);
					document.body.innerHTML += '<pre>'+JSON.stringify(msg, null, '    ')+'</pre>';
					console.log('Result length', msg.length);
				});
			};
		</script>
	</head>
	<body onload='ready()'>
	</body>
</html>
